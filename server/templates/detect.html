{% extends "base.html" %}
{% block style %} 
    <link rel="stylesheet" href="{{url_for('static', filename='detect.css')}}"> 
    <link rel="stylesheet" href="{{url_for('static', filename='index.css')}}">
{% endblock %}
{% block content %}
    <div class="result">
        {% if result %}
            <img src="{{ avatar_url }}" alt="avatar">
            <p>Your GitHub account is: <strong>{{ result }}</strong></p>
            
                <div class="features" id="followers">
                    Followers : {{ user_data[0] }}
                    <div class="square" id="square-1"></div>
                    <div class="square" id="square-2"></div>
                    <div class="square" id="square-3"></div>
                    <div class="square" id="square-4"></div>
                    <div class="square" id="square-5"></div>
                </div>
                    
                <div class="features" id="total-stars">
                    total_stars : {{ user_data[1] }}
                    <div class="square" id="square-1"></div>
                    <div class="square" id="square-2"></div>
                    <div class="square" id="square-3"></div>
                    <div class="square" id="square-4"></div>
                    <div class="square" id="square-5"></div>
                </div>   
                
                <div class="features" id="total-forks">
                    total_forks : {{ user_data[2] }}
                    <div class="square" id="square-1"></div>
                    <div class="square" id="square-2"></div>
                    <div class="square" id="square-3"></div>
                    <div class="square" id="square-4"></div>
                    <div class="square" id="square-5"></div>
                </div> 

                <div class="features" id="repo-count">
                    repo_count : {{ user_data[3] }}
                    <div class="square" id="square-1"></div>
                    <div class="square" id="square-2"></div>
                    <div class="square" id="square-3"></div>
                    <div class="square" id="square-4"></div>
                    <div class="square" id="square-5"></div>
                </div>
                
                <div class="features" id="languages">
                    Languages : {{ user_data[4] }}
                    <div class="square" id="square-1"></div>
                    <div class="square" id="square-2"></div>
                    <div class="square" id="square-3"></div>
                    <div class="square" id="square-4"></div>
                    <div class="square" id="square-5"></div>
                </div>
                
        {% else %}
            <p>Please enter a username, don't make me guess!</p>
        {% endif %}
    </div>
{% endblock %}
{% block script %}
<script>
    const item_list = [{{ user_data[0] }},{{ user_data[1] }},{{ user_data[2] }},{{ user_data[3] }},{{ user_data[4] }} ];
    const allDivs = ['followers', 'total-stars', 'total-forks', 'repo-count', 'languages'];
    let levels =  ['level-0', 'level-1', 'level-2', 'level-3', 'level-4'];

    allDivs.forEach((divId, i) => {
      const value = item_list[i];
      const squares = document.querySelectorAll(`#${divId} .square`);
      const index = Math.min(Math.floor(value / 50), 4);

      squares.forEach((square, j) => {
        if (j <= index) {
          square.classList.add(levels[j]);
        } else {
            square.classList.add(levels[0]); 
        }
      });
    });
</script>
{% endblock %}
